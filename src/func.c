#include <header.h>

// FUNCTION DEFINTIONS:

void display_wrong(char wrong_guesses[], int num_wrong)
{
    /* This function is called in print_board() */

    // Only print if they have guesses wrong already
    if (num_wrong > 0)
    {
        printf("\t\t\tWrong guesses: ");
        for (int i = 0; i < 6; i++)
        {
            // Iterate through wrong_guesses[]
            if (wrong_guesses[i] != 0)
            {
                // Don't print ',' if printing last in current state of list
                if (num_wrong == i + 1) {
                    printf("%c", wrong_guesses[i]);
                }
                else {
                    printf("%c, ", wrong_guesses[i]);
                }
            }
        }
    }

}

char *inf_buffer(char *prompt)
{
    printf("%s", prompt);

    // Allocate initial char for user input
    char *s = malloc(sizeof(char));
    if (s == NULL) {
        printf("Error: failed to allocate buffer for user input\n");
        exit(1);
    }

    // Scan command line until '\n'
    uint64_t i = 0;
    while (true) {
        int8_t test_char = getchar();
        if (test_char == EOF) {
            printf("Error: failed to scan command line for user input\n");
            exit(2);
        }

        s[i] = test_char;
        if (s[i] == '\n') {
            s[i] = '\0';
            break;
        }
        else {
            // Reallocate
            s = realloc(s, sizeof(char)*(i+2));
                if (s == NULL) {
                    printf("Error: failed to reallocate buffer for user input\n");
                    exit(3);
                }
                i++;
        }
    }

    return s;
}

void print_board(char p1_input[], char correct_guesses[], char wrong_guesses[], int num_wrong)
{
    // DISPLAY WRONG guesses under hangman
    display_wrong(wrong_guesses, num_wrong);

    printf("\nCorrect Guesses:\n\n");
    int l = strlen(p1_input);
    for (int i = 0; i < l; i++)
    {
        if (p1_input[i] == ' ' )
        {
            printf("  ");
        }
        else if (isalpha(correct_guesses[i]))
        {
            printf("%c ", p1_input[i]);
        }
        else if (isalpha(p1_input[i]))
        {
            printf("_ ");
        }
        else
        {
            printf("%c", p1_input[i]);
        }
    }
    printf("\n\n");
    printf("Body parts remaining: %i\n", 6-num_wrong);
}

void display_hangman(int wrong)
{
// printf("_|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|");
printf("_|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|");
printf("\n___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|__\n");
    if (wrong == 0)
    {
        printf("_|___|___|___|___|___|__  +---+ _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___   |   | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|__      | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_       | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_ ========= ___|___|___|___|___|___|___|___|___|\n"); // Blank hangman
    }
    else if (wrong == 1)
    {
        printf("_|___|___|___|___|___|__  +---+ _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___   |   | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_   O   | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_       | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_ ========= ___|___|___|___|___|___|___|___|___|\n");
    }
    else if (wrong == 2)
    {
        printf("_|___|___|___|___|___|__  +---+ _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___   |   | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_   O   | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___  /    | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_       | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_ ========= ___|___|___|___|___|___|___|___|___|\n");
    }
    else if (wrong == 3)
    {
        printf("_|___|___|___|___|___|__  +---+ _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___   |   | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_   O   | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___  /|   | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_       | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_ ========= ___|___|___|___|___|___|___|___|___|\n");
    }
    else if (wrong == 4)
    {
        printf("_|___|___|___|___|___|__  +---+ _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___   |   | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_   O   | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___  /|\\  | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_       | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_ ========= ___|___|___|___|___|___|___|___|___|\n");
    }
    else if (wrong == 5)
    {
        printf("_|___|___|___|___|___|__  +---+ _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___   |   | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_   O   | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___  /|\\  | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_  /    | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_ ========= ___|___|___|___|___|___|___|___|___|\n");
    }
    else
    {
        printf("_|___|___|___|___|___|__  +---+ _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___   |   | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_   O   | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___  /|\\  | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_  / \\  | _|___|___|___|___|___|___|___|___|___|\n___|___|___|___|___|___       | ___|___|___|___|___|___|___|___|___|__\n_|___|___|___|___|___|_ ========= ___|___|___|___|___|___|___|___|___|\n"); // Full hangman
    }
}

void display_title(bool scroll)
{
    if (scroll) {
        for (int i = 0; i < 45; i++) {printf("\n");}
        printf("   ~~~~~~~~~~ DON'T SCROLL UP, THAT'S CHEATING!!! ~~~~~~~~~~~~\n\n");
    }

    printf("\t\t\t~~~ HANGMAN ~~~\n");
    return;
}